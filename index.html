<!DOCTYPE html>
<html lang="ja">
<head>
  <title>Test Ventus Wallet</title>
  <link rel="stylesheet" href="./css/BGimg_ventus.css" type="text/css" media="all" id="switchCSS" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <link rel="stylesheet" href="style.css" type="text/css">
  <meta http-equiv="content-type" charset="UTF-8">
  <!-- <meta name="viewport" content="width=device-width,initial-scale=1"> -->
   
  <script src="js/jquery-3.6.3.min.js"></script>
  <script src="js/js.cookie.js"></script>
  <script>
    // CSSのURLを定義
    var defaulturl= './css/BGimg_ventus.css'
    var cyberpunkurl= './css/BGimg_cyberpunk.css';
    var seaurl= './css/BGimg_sea.css';
// 画面表示時のCSSの読み込み設定
    $(document).ready(
        function() {
            if (!Cookies.get('cookieCSS')) {
                // クッキー未登録であればデフォルト選択
                    $("#selectCSS").val("ventus");
            } else if (Cookies.get('cookieCSS') == 'ventus') {
                // クッキーにデフォルト登録であればデフォルト選択
                    $("#selectCSS").val("ventus");
                // defaultCSSを読み込む
                    $("#switchCSS").attr("href" , defaulturl);
            } else if (Cookies.get('cookieCSS') == 'cyberpunk') {
                    $("#selectCSS").val("cyberpunk");
                    $("#switchCSS").attr("href" , cyberpunkurl);
            } else if (Cookies.get('cookieCSS') == 'sea') {
                    $("#selectCSS").val("sea");
                    $("#switchCSS").attr("href" , seaurl);
            }
        }
    );
// セレクトボックス操作時の設定
    $(function(){
        $('#selectCSS').change(function(){
            // セレクトボックスのvalueを取得
                var val = $(this).val();
            // valueによって読み込むCSSを変更する
                if (val == "ventus") {
                    cssurl = defaulturl;
                } else if (val == "cyberpunk") {
                    cssurl = cyberpunkurl;
                } else if  (val == "sea") {
                     cssurl = seaurl;
                }         
            // 選択結果をクッキーに登録する
                Cookies.set('cookieCSS', val);
            // CSSを読み込む
                $("#switchCSS").attr("href" , cssurl);
        });
    });    
    
    select_Node(value);
    
    function select_Node(value){
         const node1 = value;
         console.log("node1=",node1);
    }
    
  </script>
</head>
<body> 
  
  <div class="SSS_link">
       <a href="./Terms_of_use.html" target="_blank">利用規約</a>
       <a href="https://note.com/mikun_nem/n/n5c21f4af8930/" target="_blank">/ 使い方</a>
       <div style="display: inline-block; _display: inline;" id="explorer"></div>
       <a href="https://docs.sss-symbol.com/ja/" target="_blank">/ SSS_Extension /</a>
       <a href="https://note.com/mahorobart/n/nd5f226887c2a" target="_blank">Ventusについて</a>
       <a href="https://github.com/mikunNEM/Ventus_Wallet" target="_blank">/ GitHub </a> 
       <a href="https://symbol-community.com" target="_blank">/ Symbol_Community_Web /</a>
       <select id="selectCSS">
           <option value="ventus">Ventus</option>
           <option value="cyberpunk">CyberPunk</option>
           <option value="sea">Sea</option>
　     </select>
       <select id="Node" onchange="select_Node();">
           <option value="https://symbol-mikun.net:3001">Symbol_MainNet</option>
           <option value="https://mikun-testnet.tk:3001">Symbol_TestNet</option>
           <option value="https://canade.mikun-testnet.tk:3001">Canade_TestNet</option>
　     </select> 
  </div> 
  
  <h1>Test Ventus Wallet</h1>
  <h3><div id="netType"></div></h3>  
  <div class="wrapper">
      <div class="left">
        <div class="account-card">
            <h2>Account Info</h2>
            <hr>
          <div class="container" style="color:#2f4f4f">   
            <div id="wallet-addr"></div>
          </div>
          <div class="container" style="color:blue;">
            <div id="wallet-xym"></div>
          </div>
        </div>
        
        <div class="sender-card">
          <h2>Send</h2>
          <hr>
          <br>
          <div class="textfiled-wrapper">
            <div>To: Address / 宛先</div>
            <input type="text" id="form-addr" class="textfiled" />
          </div>
          
          <div class="textfiled-wrapper">
            <div>Mosaic　　/ モザイク</div>
            <select id="form-mosaic_ID" name="form-mosaic_ID" class="textfiled"></select>         <!--   セレクトボックス     -->
          </div>
          
          <div class="textfiled-wrapper">
            <div>Amount 　/ 数量</div>
            <input type="text" id="form-amount" class="textfiled" style="line-height:1"/>
          </div>
        
          <div class="textfiled-wrapper">
            <div>Message　/ メッセージ</div>
            <input type="text" id="form-message" class="textfiled" style="line-height:3"/>
          </div>  
        
          <div class="textfiled-wrapper">
            <div></div>
            <select id="form-enc">
            <option value="0">Plain message　　　(平文)</option>
            <option value="1">Encrypted message (暗号化)</option>       
            </select>
          </div>
          
          <div class="textfiled-wrapper">
            <div>maxFee / 最大手数料 / aggregateTx (x20)</div>
            <select id="form-maxfee">
              <option value="0.02">0.02 xym (slow)</option>
              <option value="0.04">0.04 xym</option>
              <option value="0.07">0.07 xym</option>
              <option value="0.10"> 0.10 xym (fast)</option>
            </select>
          </div> 
   
         <label>
             <input type="file" id="upload-file">ファイルを選択(.csv)       <!-- address ファイルを選択 --> 
         </label>
         <div style="display: inline-block; _display: inline;"> 
           <p1>選択されていません</p1>
         </div>
          <script>           
              const input = document.getElementById('upload-file');
              //FileReaderの定義
              const reader = new FileReader();
              let address1 = [];
              let address2 = [];
              let file;
              // 選択したファイルのファイル名を出力する
 　　　　　　   　　　　　$('input').on('change', function () {
        　　　　　　　　　　　let file = $(this).prop('files')[0];
        　　　　　　　　　　　$('p1').text(file.name);
                          address1.length = 0;
                          address2.length = 0; 
   　　　　　　　　　　　 });
                        
              input.addEventListener('change', (e) => {
                  const file1 = e.target.files[0];
                  console.log("file1=",file1);
                    if (typeof file1 === "undefined"){
                       address1.length = 0;
                       address2.length = 0; // ファイル選択が取り消された場合、配列を削除
                       $('p1').text("選択されていません"); 
                       file = file1;
                    }
                
                  //ファイルの種類を絞る
                  if (file1.type === 'text/csv') {                    　                   
                     reader.onload = () => {
                       //console.log(reader.result);
                       address2 = reader.result.split(/\r\n|\n/);   //splitで改行ごとに配列化
                       
                        for (let i = 0; i < address2.length; ++i) {  
                             let cells = address2[i].split(",");    //カンマごとに配列化 (名前とアドレスを分ける)
                             address1[i] = cells[1];                //アドレスだけを格納
                       }
                       
                       console.log(address1);
                     }
                     reader.readAsText(file1);
                  }
              });        
          </script>
         
          <div id="button-haichi">
             <input type="button" onclick="handleSSS();" value="Send" class="button-sign"/>
          </div>                    
        </div>
    
         <div id="version"></div>
         
      </div>
      <div class="right">
        <div class="tx-card">
          <h2>Tx History</h2>        
            
            <div style="text-align: right">
            <div style="display: inline-block; _display: inline;">Page:</div>
              
              <select id="page_num1" onchange="select_Page();">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
              </select> 
            </div> 
     
          <hr>
          <div id="wallet-transactions"></div>   <!--  トランザクション履歴   --> 
                   
        </div>
      </div>
  </div>

　 <div id="popup" class="popup">
    <div class="popup-inner">
      <div class="img"><img src="unicorn2.gif" alt="ポップアップ画像"></div>
    </div><!-- .popup-inner -->
    <div id="bg-black" class="bg-black"></div>
  </div><!-- #popup -->
 
  <script type="text/javascript" src="https://xembook.github.io/nem2-browserify/symbol-sdk-pack-2.0.3.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
  <script type="text/javascript" src="script.js"></script>
</body>
</html>
